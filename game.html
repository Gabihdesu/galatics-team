<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="./static/imgs/Logo_branco.webp" type="image/x-icon">
    <title>Earth Defense - Asteroid Defender</title>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }


	body {
    		margin: 0;
    		padding: 0;
    		box-sizing: border-box;
    		font-family: 'Orbitron', sans-serif;
    		background-color: #000;
    		color: #fff;
    		height: 100vh;
   		overflow: hidden;
    		display: flex;
   		flex-direction: column; /* muda para coluna */
    		align-items: center; /* mant√©m o conte√∫do centralizado na horizontal */
    		justify-content: flex-start; /* come√ßa do topo da tela */
    		position: relative;
    		padding-top: 20px; /* d√° um pequeno respiro no topo */
	}


        /* ===== Starry Background ===== */
        #stars {
        position: absolute;
        width: 100%;
        height: 100%;
        background: black;
        overflow: hidden;
        z-index: 0;
    }

    .star {
        position: absolute;
        background: white;
        border-radius: 50%;
        opacity: 0.8;
        animation: moveStar linear infinite;
    }

    @keyframes moveStar {
        from { transform: translateY(0) scale(1); opacity: 1; }
        to { transform: translateY(100vh) scale(0.5); opacity: 0; }
    }


        .container {
            max-width: 70%;
            text-align: center;
            z-index: 2;
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #60a5fa, #a78bfa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #94a3b8;
            margin-bottom: 30px;
        }

        .game-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            gap: 20px;
        }

        .stat {
            flex: 1;
            padding: 12px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .stat-label {
            font-size: 0.875rem;
            color: #94a3b8;
            margin-bottom: 4px;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #60a5fa;
        }

        #gameCanvas {
            border-radius: 8px;
            background: #000;
            cursor: crosshair;
            max-width: 100%;
            display: block;
            margin: 0 auto;
        }

        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
        }

        .overlay-content {
            text-align: center;
            padding: 20px;
        }

        .overlay-content h2 {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        .overlay-content h3 {
            font-size: 1.25rem;
            margin-bottom: 16px;
            margin-top: 16px;
        }

        .difficulty-buttons {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            justify-content: center;
        }

        button {
            padding: 12px 32px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            background: #3b82f6;
            color: white;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        button.outline {
            background: transparent;
            border: 2px solid #3b82f6;
            color: #3b82f6;
        }

        button.outline:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        button.active {
            background: #3b82f6;
            color: white;
        }

        button.hard {
            background: #ef4444;
            border-color: #ef4444;
        }

        button.hard.outline {
            background: transparent;
            color: #ef4444;
        }

        .instructions {
            margin-top: 20px;
            color: #94a3b8;
            font-size: 0.875rem;
        }

        .canvas-wrapper {
            position: relative;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="game-card">
            <div class="stats">
                <div class="stat">
                    <div class="stat-label">Score</div>
                    <div class="stat-value" id="scoreDisplay">0</div>
                    <audio id="bgMusic" autoplay loop>
                        <source src="../static/audio/gamin.wav" type="audio/mpeg">
                        Your browser does not support the audio tag.
                    </audio>
                    
                    
                </div>
            
                <div class="stat">
                    <div class="stat-label">Lifes</div>
                    <div class="stat-value" id="livesDisplay">3</div>
                </div>
            </div>

            <div class="canvas-wrapper">
                <canvas id="gameCanvas" width="800" height="600"></canvas>
                
                <div id="startOverlay" class="overlay">
                    <div class="overlay-content">
                        <h3>Choose Difficulty</h3>
                        <div class="difficulty-buttons">
                            <button id="easyBtn" class="active" onclick="setDifficulty('easy')">Easy</button>
                            <button id="mediumBtn" class="outline" onclick="setDifficulty('medium')">Medium</button>
                            <button id="hardBtn" class="outline hard" onclick="setDifficulty('hard')">Hard</button>
                        </div>
                        <button onclick="startGame()" class="pulse">Play game</button>
                    </div>
                </div>

                <div id="gameOverOverlay" class="overlay" style="display: none;">
                    <div class="overlay-content">
                        <h2>Game Over!</h2>
                        <p style="font-size: 1.25rem; margin-bottom: 20px;">Final Score: <span id="finalScore">0</span></p>
                        <h3>Choose Difficulty</h3>
                        <div class="difficulty-buttons">
                            <button id="easyBtn2" onclick="setDifficulty('easy')">Easy</button>
                            <button id="mediumBtn2" onclick="setDifficulty('medium')">Medium</button>
                            <button id="hardBtn2" class="hard" onclick="setDifficulty('hard')">Hard</button>
                        </div>
                        <button onclick="startGame()" class="pulse">Play Again</button>
                    </div>
                </div>
            </div>

            <div class="instructions">
                <p>üéØ Click on the asteroids to destroy them before they hit Earth!</p>
                <p>‚ö†Ô∏è Each asteroid that hits Earth costs 1 life</p>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let score = 0;
        let lives = 3;
        let gameOver = false;
        let gameStarted = false;
        let difficulty = 'easy';
        
        let asteroids = [];
        let particles = [];
        let bullets = [];
        let animationFrame = null;
        let lastSpawn = 0;
        
        const earth = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            radius: 60
        };
        
        const earthImg = new Image();
        earthImg.src = 'data:image/svg+xml,' + encodeURIComponent(`
    <svg width="120" height="120" xmlns="http://www.w3.org/2000/svg">
        <defs>
            <!-- Gradiente para o oceano -->
            <radialGradient id="earthGrad" cx="50%" cy="50%" r="50%">
                <stop offset="0%" stop-color="#63b3ed"/>
                <stop offset="100%" stop-color="#2c5282"/>
            </radialGradient>

            <!-- Sombra suave no globo -->
            <radialGradient id="shadowGrad" cx="60%" cy="60%" r="60%">
                <stop offset="0%" stop-opacity="0"/>
                <stop offset="100%" stop-opacity="0.2"/>
            </radialGradient>
        </defs>

        <!-- Globo -->
        <circle cx="60" cy="60" r="60" fill="url(#earthGrad)"/>

        <!-- Continentes maiores -->
        <path d="M35,25 C45,10 65,20 70,35 C75,45 50,50 40,40 Z" fill="#38a169" opacity="0.9"/>
        <path d="M65,55 C75,45 95,55 90,65 C85,75 70,70 65,55 Z" fill="#38a169" opacity="0.9"/>
        <path d="M40,80 C50,70 70,75 65,85 C60,95 45,90 40,80 Z" fill="#38a169" opacity="0.9"/>
        <path d="M25,50 C35,45 40,55 30,60 C20,65 20,55 25,50 Z" fill="#38a169" opacity="0.8"/>

        <!-- Brilhos atmosf√©ricos -->
        <circle cx="30" cy="30" r="10" fill="white" opacity="0.2"/>
        <circle cx="85" cy="40" r="7" fill="white" opacity="0.15"/>

        <!-- Sombra para profundidade -->
        <circle cx="60" cy="60" r="60" fill="url(#shadowGrad)"/>
    </svg>
`);


        
        const stars = [];
        for (let i = 0; i < 100; i++) {
            stars.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 1.5
            });
        }
        
        function setDifficulty(diff) {
            difficulty = diff;
            updateDifficultyButtons();
        }
        
        function updateDifficultyButtons() {
            ['easyBtn', 'easyBtn2'].forEach(id => {
                const btn = document.getElementById(id);
                btn.className = difficulty === 'easy' ? 'active' : 'outline';
            });
            ['mediumBtn', 'mediumBtn2'].forEach(id => {
                const btn = document.getElementById(id);
                btn.className = difficulty === 'medium' ? 'active' : 'outline';
            });
            ['hardBtn', 'hardBtn2'].forEach(id => {
                const btn = document.getElementById(id);
                btn.className = difficulty === 'hard' ? 'active hard' : 'outline hard';
            });
        }
        
        function spawnAsteroid() {
            const side = Math.floor(Math.random() * 4);
            let x, y;
            
            if (side === 0) { x = Math.random() * canvas.width; y = -30; }
            else if (side === 1) { x = canvas.width + 30; y = Math.random() * canvas.height; }
            else if (side === 2) { x = Math.random() * canvas.width; y = canvas.height + 30; }
            else { x = -30; y = Math.random() * canvas.height; }
            
            const angle = Math.atan2(earth.y - y, earth.x - x);
            const speedMultiplier = difficulty === 'easy' ? 0.7 : difficulty === 'hard' ? 1.5 : 1;
            
            asteroids.push({
                x, y,
                radius: 15 + Math.random() * 20,
                speed: (0.5 + Math.random() * 1.5) * speedMultiplier,
                angle,
                rotation: Math.random() * Math.PI * 2
            });
        }
        
        function createExplosion(x, y) {
            const colors = ['#ff6b35', '#f7931e', '#fdc830', '#fc4a1a'];
            for (let i = 0; i < 20; i++) {
                const angle = (Math.PI * 2 * i) / 20;
                particles.push({
                    x, y,
                    vx: Math.cos(angle) * (2 + Math.random() * 3),
                    vy: Math.sin(angle) * (2 + Math.random() * 3),
                    life: 1,
                    color: colors[Math.floor(Math.random() * colors.length)]
                });
            }
        }
        
        function startGame() {
            score = 0;
            lives = 3;
            gameOver = false;
            gameStarted = true;
            asteroids = [];
            particles = [];
            bullets = [];
            lastSpawn = 0;
            
            document.getElementById('startOverlay').style.display = 'none';
            document.getElementById('gameOverOverlay').style.display = 'none';
            document.getElementById('scoreDisplay').textContent = score;
            document.getElementById('livesDisplay').textContent = lives;
            const bgMusic = document.getElementById('bgMusic');

            if (bgMusic) {
                bgMusic.play().catch(e => {
                    console.log('Autoplay falhou:', e);
                });
            }
            if (animationFrame) cancelAnimationFrame(animationFrame);
            gameLoop(0);
        }
        
        canvas.addEventListener('click', (e) => {
            if (!gameStarted || gameOver) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            
            bullets.push({ x: earth.x, y: earth.y, targetX: x, targetY: y, speed: 8 });
        });
        
        function gameLoop(timestamp) {
            if (!gameStarted || gameOver) return;
            
            ctx.fillStyle = '#000000';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw stars
            ctx.fillStyle = '#ffffff';
            stars.forEach(star => {
                ctx.beginPath();
                ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                ctx.fill();
            });
            
            // Spawn asteroids
            const spawnInterval = difficulty === 'easy' ? 3000 : difficulty === 'hard' ? 1200 : 2000;
            if (timestamp - lastSpawn > spawnInterval) {
                spawnAsteroid();
                lastSpawn = timestamp;
            }
            
            // Update and draw bullets
            for (let i = bullets.length - 1; i >= 0; i--) {
                const bullet = bullets[i];
                const dx = bullet.targetX - bullet.x;
                const dy = bullet.targetY - bullet.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist < bullet.speed) {
                    bullets.splice(i, 1);
                    continue;
                }
                
                bullet.x += (dx / dist) * bullet.speed;
                bullet.y += (dy / dist) * bullet.speed;
                
                // Check collision with asteroids
                for (let j = asteroids.length - 1; j >= 0; j--) {
                    const asteroid = asteroids[j];
                    const adx = bullet.x - asteroid.x;
                    const ady = bullet.y - asteroid.y;
                    const distance = Math.sqrt(adx * adx + ady * ady);
                    
                    if (distance < asteroid.radius) {
                        createExplosion(asteroid.x, asteroid.y);
                        asteroids.splice(j, 1);
                        bullets.splice(i, 1);
                        score += 10;
                        document.getElementById('scoreDisplay').textContent = score;
                        break;
                    }
                }
                
                // Draw bullet
                ctx.fillStyle = '#60a5fa';
                ctx.beginPath();
                ctx.arc(bullet.x, bullet.y, 3, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // Update and draw asteroids
            for (let i = asteroids.length - 1; i >= 0; i--) {
                const asteroid = asteroids[i];
                asteroid.x += Math.cos(asteroid.angle) * asteroid.speed;
                asteroid.y += Math.sin(asteroid.angle) * asteroid.speed;
                asteroid.rotation += 0.02;
                
                // Check collision with Earth
                const dx = asteroid.x - earth.x;
                const dy = asteroid.y - earth.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < earth.radius + asteroid.radius) {
                    createExplosion(asteroid.x, asteroid.y);
                    asteroids.splice(i, 1);
                    lives--;
                    document.getElementById('livesDisplay').textContent = lives;
                    
                    if (lives <= 0) {
                        gameOver = true;
                        document.getElementById('finalScore').textContent = score;
                        document.getElementById('gameOverOverlay').style.display = 'flex';
                        updateDifficultyButtons();
                        return;
                    }
                    continue;
                }
                
                // Draw asteroid
                ctx.save();
                ctx.translate(asteroid.x, asteroid.y);
                ctx.rotate(asteroid.rotation);
                ctx.fillStyle = '#78716c';
                ctx.strokeStyle = '#57534e';
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (let j = 0; j < 8; j++) {
                    const angle = (Math.PI * 2 * j) / 8;
                    const radius = asteroid.radius * (0.8 + Math.random() * 0.4);
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius;
                    if (j === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.closePath();
                ctx.fill();
                ctx.stroke();
                ctx.restore();
            }
            
            // Update and draw particles
            for (let i = particles.length - 1; i >= 0; i--) {
                const p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life -= 0.02;
                
                if (p.life <= 0) {
                    particles.splice(i, 1);
                    continue;
                }
                
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.life;
                ctx.beginPath();
                ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1;
            }
            
            // Draw Earth
            ctx.drawImage(earthImg, earth.x - earth.radius, earth.y - earth.radius, earth.radius * 2, earth.radius * 2);
            
            animationFrame = requestAnimationFrame(gameLoop);
        }
    </script>
</body>
</html>